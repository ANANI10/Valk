<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="vente.component.css">

    <title>Ajouter Vente</title>
</head>

<body>

    <mat-card>
        <mat-card-content class="vente-container" style="font-family: 'Times New Roman', Times, serif">
            <span class="vente">Vente</span>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">Ajouter
                une Vente</button>

            <!-- Modale pour afficher le formulaire -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="exampleModalLabel"
                                style="font-family: 'Times New Roman', Times, serif;">Formulaire d'Ajout de vente</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <!-- Formulaire d'Ajout de categorie -->
                            <form class="row g-3" [formGroup]="venteForm" (ngSubmit)="onAddVente()">
                                <div class="col-mb-4">
                                    <label for="quantiteVente" class="form-label">Quantite Vente : </label>
                                    <input type="number" class="form-control" id="quantiteVente"
                                        placeholder="Entrez le quantiteVente du produit" formControlName="quantiteVente"
                                        (input)="updateTotalVente()">
                                    <div *ngIf="venteForm.get('quantiteVente')?.invalid && (venteForm.get('quantiteVente')?.dirty || venteForm.get('quantiteVente')?.touched)"
                                        class="alert alert-danger">
                                        <div *ngIf="venteForm.get('quantiteVente')?.errors?.['required']">
                                            Quantité vente est requis.
                                        </div>
                                    </div>
                                </div>

                                <div class="col-mb-4">
                                    <label for="dateVente" class="form-label"> Date Vente: </label>
                                    <input type="date" class="form-control" id="dateVente"
                                        placeholder="Entrez la dateVente du produit" formControlName="dateVente">
                                    <div *ngIf="venteForm.get('dateVente')?.invalid && (venteForm.get('dateVente')?.dirty || venteForm.get('dateVente')?.touched)"
                                        class="alert alert-danger">
                                        <div *ngIf="venteForm.get('dateVente')?.errors?.['required']">
                                            Date vente est requis.
                                        </div>
                                    </div>
                                </div>

                                <div class="col-mb-4">
                                    <select class="form-select form-select-sm" formControlName="produitId"
                                        aria-label="Small select example" placeholder="Selectionner la catégorie">
                                        <option selected *ngFor="let produit of produits" [value]="produit.id">
                                            {{produit.id}} ,  {{produit.nom}} , {{produit.prix}} frcs , {{produit.quantiteStock}}

                                            
                                        </option>
                                    </select>
                                </div>

                                <div class="col-mb-4">
                                    <label for="prixVente" class="form-label"> Prix Vente : </label>
                                    <input type="number" class="form-control" id="prixVente"
                                        placeholder="Entrez le prixVente du produit" formControlName="prixVente"
                                        (input)="updateTotalVente()">
                                    <div *ngIf="venteForm.get('prixVente')?.invalid && (venteForm.get('prixVente')?.dirty || venteForm.get('prixVente')?.touched)"
                                        class="alert alert-danger">
                                        <div *ngIf="venteForm.get('prixVente')?.errors?.['required']">
                                            prixVente du Produit est requis.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-mb-4">
                                    <label for="totalVente" class="form-label"> Total Vente : </label>
                                    <input type="number" class="form-control" id="totalVente"
                                        placeholder="Entrez le prixVente du produit" formControlName="totalVente">
                                    <div *ngIf="venteForm.get('totalVente')?.invalid && (venteForm.get('totalVente')?.dirty || venteForm.get('prixVente')?.touched)"
                                        class="alert alert-danger">
                                        <div *ngIf="venteForm.get('totalVente')?.errors?.['required']">
                                            TotalVente du Produit est requis.
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="successMessage" class="alert alert-success mt-3">
                {{ successMessage }}
            </div>

        </mat-card-content>
    </mat-card>

    <br>



    <nav id="navbar-example2" class="navbar bg-body-tertiary px-3 mb-3" style="font-family: 'Times New Roman', Times, serif;">
        Liste Des Ventes
    </nav>


    <div class="search-bar">
        <input [(ngModel)]="searchValue" style="font-family: 'Times New Roman', Times, serif;" placeholder="Rechercher une vente" />
        <i class="fas fa-search"></i>
    </div>

    <style>
        .custom-btn {
          border: none;
          outline: none;
          box-shadow: none;
          background-color: white;
        }
    </style>

    <table class="table" style="font-family: 'Times New Roman', Times, serif;">
        <thead>
            <tr>
                <th scope="col">Id</th>
                <th scope="col">Quantité Vente </th>
                <th scope="col">PrixVente</th>
                <th scope="col">Date</th>
                <th scope="col">TotalVente</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody class="table-group-divider">
            <tr *ngFor="let vente of filteredVente">
                <td> {{ vente.venteId }}</td>
                <td> {{ vente.quantiteVente }} </td>
                <td> {{ vente.prixVente }} </td>
                <td> {{ vente.dateVente }} </td>
                <td> {{ vente.totalVente }} </td>
                <td>
                    <div style="display: flex; gap: 20px;">
                        <button class="icon-button" (click)="onDeleteVenteConfirmation(vente.venteId)"><i
                                class="fas fa-trash-alt" style="color: red;"></i></button>
                        <a routerLink="/dashboard/updateProd"> <i class="fas fa-edit" style="color: blue;"></i> </a>
                        <!-- Ajoutez ceci à l'endroit approprié dans votre boucle ngFor pour afficher les ventes -->
                        <button type="button" data-bs-toggle="modal" data-bs-target="#exampleModal1" class="custom-btn"
                            style="color: blue;">
                            <i class="fas fa-eye"></i>
                            <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog modal-xl">
                                    <div class="modal-content">
                                        <div class="modal-body">
                                            <!-- Formulaire d'Ajout de categorie -->
                                            <div class="modal-dialog modal-xl">
                                                <table class="table" style="font-family: 'Times New Roman', Times, serif;">
                                                    <thead style="font-family: 'Times New Roman', Times, serif;">
                                                        <tr style="font-family: 'Times New Roman', Times, serif;">
                                                            <th scope="col">Id</th>
                                                            <th scope="col">NomProduit</th>
                                                            <th scope="col">QuantiteStock</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table-group-divider" style="font-family: 'Times New Roman', Times, serif;">
                                                        <tr *ngIf="selectedProduct">
                                                            <td style="font-family: 'Times New Roman', Times, serif;">{{ selectedProduct.id }}</td>
                                                            <td>{{ selectedProduct.nom }}</td>
                                                            <td>{{ selectedProduct.quantiteStock }}</td>
                                                        </tr>
                                                        <!-- Ajoutez d'autres propriétés du produit que vous souhaitez afficher -->
                                                    </tbody>
                                                </table>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- Ajoutez le contenu modal ici (nous gardons cela simple pour la démonstration) -->

                        </button>


                    </div>
                </td>

            </tr>
        </tbody>
    </table>





    <div class="container">
        <router-outlet></router-outlet>
    </div>

    <!-- Dans votre fichier HTML -->
    <!-- Nouveaux scripts Bootstrap 5 -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>

</body>

</html>